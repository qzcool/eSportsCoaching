<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper    
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"    
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.gt.dao.user.UserDao">

<!-- profile.jsp中的更换图片前验证是否登录状态 -->
	<resultMap type="int" id="resultId02">
		<result column="u_id" property="uId"/>
	</resultMap>
	<select id="findId" parameterType="string" resultMap="resultId02">
		select uId from gt_user where u_name=#{value}
	</select>

<!-- profile.jsp中的更换图片 -->
	<insert id="upload" >
		insert into gt_user(u_img) values (#{idPicPath}) where u_id=#{uId}
	</insert>

<!-- 登录 -->
	<resultMap type="user" id="resultId01">
		<result column="u_id" property="uId"/>
	</resultMap>
	<select id="selectUser" parameterType="user" resultMap="resultId01">
		select u_id from gt_user where u_name=#{name} and u_pwd=#{pwd}
	</select>

<!-- 判断账号是否可用 -->
	<resultMap type="user" id="resultId00">
		<result column="u_name" property="name"/>
	</resultMap>
	<select id="userNameExist" parameterType="string" resultMap="resultId00">
		select u_name from gt_user where u_name=#{value}
 	</select>

<!-- 添加用户 -->
	<insert id="addUser" parameterType="user">
		<selectKey keyProperty="uId" resultType="int" order="AFTER">
			select LAST_INSERT_ID()
		</selectKey>
		insert into gt_user(u_name, u_pwd, u_role) values(#{name}, #{pwd}, #{role})
	</insert>
</mapper>